# æ™ºèƒ½æç¤ºè¯ç”Ÿæˆç³»ç»Ÿ - ä½¿ç”¨æŒ‡å—

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ª**æ ¹æœ¬æ€§è§£å†³æ–¹æ¡ˆ**ï¼Œä¸æ˜¯ä¸´æ—¶è¡¥ä¸ï¼

### æ ¸å¿ƒç‰¹æ€§

âœ… **è¯­ä¹‰ç†è§£** - ç†è§£"åŠ¨æ¼«é£æ ¼" â‰  "åŠ¨æ¼«ç»¿çœ¼ç›"
âœ… **å¸¸è¯†æ¨ç†** - çŸ¥é“"ä¸œäºšäººé€šå¸¸æ˜¯æ£•è‰²/é»‘è‰²çœ¼ç›"
âœ… **ä¸€è‡´æ€§æ£€æŸ¥** - è‡ªåŠ¨æ£€æµ‹"ä¸œäºšäºº+ç»¿çœ¼ç›"ç­‰é€»è¾‘å†²çª
âœ… **æ™ºèƒ½ä¿®æ­£** - è‡ªåŠ¨ä¿®å¤ä¸åˆç†çš„ç»„åˆ
âœ… **é›¶é¢å¤–æˆæœ¬** - ä½¿ç”¨Claudeæœ¬èº«çš„æ™ºèƒ½ï¼Œæ— éœ€APIè°ƒç”¨

---

## ğŸ“‹ æ¶æ„

```
ç”¨æˆ·è¾“å…¥ï¼š"èµ›åšæœ‹å…‹é£æ ¼çš„åŠ¨æ¼«å°‘å¥³"
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Claude (Skill)                      â”‚
â”‚ - ç†è§£ï¼šä¸œäºšå¥³æ€§ + åŠ¨æ¼«ç”»é£ +        â”‚
â”‚         èµ›åšæœ‹å…‹æ°›å›´                  â”‚
â”‚ - åŒºåˆ†ï¼šä¸»ä½“å±æ€§ vs è§†è§‰é£æ ¼         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ intelligent_generator.py            â”‚
â”‚ - æŸ¥è¯¢æ•°æ®åº“ï¼ˆ921å…ƒç´ ï¼‰              â”‚
â”‚ - æ£€æŸ¥ä¸€è‡´æ€§                         â”‚
â”‚ - ä¿®æ­£å†²çª                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
å®Œç¾çš„æç¤ºè¯ï¼ˆæ— é€»è¾‘å†²çªï¼‰
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼1ï¼šé€šè¿‡å¯¹è¯ï¼ˆæ¨èï¼‰

ç›´æ¥åœ¨Claude Codeä¸­è¯´ï¼š

```
"ç”Ÿæˆèµ›åšæœ‹å…‹é£æ ¼çš„åŠ¨æ¼«å°‘å¥³æç¤ºè¯"
```

æˆ‘ä¼šè‡ªåŠ¨ï¼š
1. ç†è§£ä½ çš„æ„å›¾
2. è°ƒç”¨intelligent_generator.py
3. æ£€æŸ¥ä¸€è‡´æ€§
4. è¿”å›å®Œç¾æç¤ºè¯

### æ–¹å¼2ï¼šç›´æ¥ä½¿ç”¨Python

```python
from intelligent_generator import IntelligentGenerator

gen = IntelligentGenerator()

intent = {
    'subject': {
        'gender': 'female',
        'ethnicity': 'East_Asian',
        'age_range': 'young_adult'
    },
    'visual_style': {
        'art_style': 'anime'
    },
    'atmosphere': {
        'theme': 'cyberpunk'
    }
}

# é€‰æ‹©å…ƒç´ 
elements = gen.select_elements_by_intent(intent)

# æ£€æŸ¥ä¸€è‡´æ€§
issues = gen.check_consistency(elements)

# ä¿®æ­£å†²çª
if issues:
    elements, fixes = gen.resolve_conflicts(elements, issues)
    for fix in fixes:
        print(fix)

# ç”Ÿæˆæç¤ºè¯
prompt = gen.compose_prompt(elements, mode='auto', keywords_limit=3)
print(prompt)

gen.close()
```

---

## ğŸ’¡ ç³»ç»Ÿå¦‚ä½•è§£å†³"ç»¿çœ¼ç›é—®é¢˜"

### ä¹‹å‰çš„é—®é¢˜ï¼ˆå…³é”®è¯åŒ¹é…ï¼‰

```
"èµ›åšæœ‹å…‹é£æ ¼çš„åŠ¨æ¼«å°‘å¥³"
    â†“
æå–ï¼š['anime', 'cyberpunk', 'girl']
    â†“
æœç´¢ï¼šæ‰€æœ‰åŒ…å«'anime'çš„å…ƒç´ 
    â†“
æ‰¾åˆ°ï¼šanime_hybrid_green_eyes
    â†“
âŒ ç»“æœï¼šä¸œäºšå¥³æ€§ + ç»¿çœ¼ç›ï¼ˆé€»è¾‘çŸ›ç›¾ï¼‰
```

### ç°åœ¨çš„è§£å†³æ–¹æ¡ˆï¼ˆæ™ºèƒ½ç†è§£ï¼‰

```
"èµ›åšæœ‹å…‹é£æ ¼çš„åŠ¨æ¼«å°‘å¥³"
    â†“
Claudeç†è§£ï¼š
- ä¸»ä½“ï¼šä¸œäºšå¥³æ€§
- ç”»é£ï¼šanimeï¼ˆå¦‚ä½•ç”»ï¼Œä¸æ”¹å˜å±æ€§ï¼‰
- æ°›å›´ï¼šcyberpunkï¼ˆåœºæ™¯ï¼Œä¸æ˜¯äººç‰©ï¼‰
    â†“
æŸ¥è¯¢æ•°æ®åº“ï¼š
- gender: female âœ“
- ethnicity: East_Asian âœ“
- eyes: almond (è‡ªåŠ¨é€‰æ‹©ç¬¦åˆä¸œäºšäººçš„) âœ“
    â†“
æ£€æŸ¥ä¸€è‡´æ€§ï¼š
- æ£€æµ‹åˆ°ä¸œäºšäºº+ç»¿çœ¼ç›ï¼Ÿâ†’ è‡ªåŠ¨ä¿®æ­£ä¸ºæ£•è‰²
    â†“
âœ… ç»“æœï¼šé€»è¾‘ä¸€è‡´çš„æç¤ºè¯
```

---

## ğŸ§  å¸¸è¯†çŸ¥è¯†åº“

ç³»ç»Ÿå†…ç½®çš„å¸¸è¯†ï¼ˆå¯æ‰©å±•ï¼‰ï¼š

### äººç§ â†’ å…¸å‹çœ¼ç›é¢œè‰²

```python
'ethnicity_typical_eyes': {
    'East_Asian': ['black', 'dark brown', 'brown'],
    'European': ['blue', 'green', 'brown', 'hazel', 'grey'],
    'African': ['dark brown', 'black', 'brown'],
    'Middle_Eastern': ['brown', 'dark brown', 'hazel', 'black'],
}
```

### é£æ ¼ç±»å‹å®šä¹‰

```python
'style_types': {
    'anime': {
        'type': 'art_style',           # è¿™æ˜¯ç”»é£
        'affects': 'rendering',        # å½±å“å‘ˆç°æ–¹å¼
        'description': 'åŠ¨æ¼«ç»˜ç”»é£æ ¼'
    },
    'cyberpunk': {
        'type': 'atmosphere',          # è¿™æ˜¯æ°›å›´
        'affects': 'scene',            # å½±å“åœºæ™¯
        'description': 'èµ›åšæœ‹å…‹åœºæ™¯æ°›å›´'
    }
}
```

---

## ğŸ“Š æµ‹è¯•ç»“æœ

### æµ‹è¯•1ï¼šèµ›åšæœ‹å…‹åŠ¨æ¼«å°‘å¥³

**è¾“å…¥**ï¼š"èµ›åšæœ‹å…‹é£æ ¼çš„åŠ¨æ¼«å°‘å¥³"

**æ£€æµ‹**ï¼šâœ… æ— å†²çªï¼ˆè‡ªåŠ¨é€‰æ‹©äº†almond eyesï¼‰

**è¾“å‡º**ï¼š
```
woman, female, lady, young, youthful, young adult, East Asian, Chinese, Japanese,
large expressive eyes, almond eyes, thick natural lashes, black hair hair,
fair skin, pale skin, pale complexion, realistic skin texture, visible pores,
natural imperfections, oval face, delicate refined Asian facial structure, ...
```

**éªŒè¯**ï¼š
- âœ… æ²¡æœ‰ç»¿çœ¼ç›
- âœ… äººç§å’Œçœ¼ç›é¢œè‰²ä¸€è‡´
- âœ… 'anime'åªå½±å“ç”»é£ï¼Œæ²¡æœ‰æ”¹å˜äººç‰©å±æ€§

---

### æµ‹è¯•2ï¼šæ¨¡æ‹Ÿå†²çªä¿®æ­£

**æ„é€ å†²çª**ï¼šä¸œäºšäºº + anime_hybrid_green_eyes

**ç³»ç»Ÿå“åº”**ï¼š
```
âš ï¸ å‘ç°é—®é¢˜: ä¸œäºšäººé€šå¸¸ä¸ä¼šæœ‰åŒ…å«'green, blue, violet'çš„çœ¼ç›

ğŸ”§ åº”ç”¨æ™ºèƒ½ä¿®æ­£...
âœ“ ä¿®æ­£çœ¼ç›: 'anime hybrid green eyes' â†’ 'almond brown eyes'
  (ç¬¦åˆä¸œäºšäººç‰¹å¾)

âœ… ä¿®æ­£æˆåŠŸï¼šå·²ç§»é™¤ç»¿è‰²çœ¼ç›ï¼Œç¬¦åˆä¸œäºšäººç‰¹å¾
```

---

## ğŸ”§ æ‰©å±•ç³»ç»Ÿ

### æ·»åŠ æ–°çš„äººç§

ç¼–è¾‘ `intelligent_generator.py`ï¼š

```python
'ethnicity_typical_eyes': {
    'New_Ethnicity': ['color1', 'color2', 'color3'],
}

'ethnicity_typical_hair': {
    'New_Ethnicity': ['hair_color1', 'hair_color2'],
}
```

### æ·»åŠ æ–°çš„çº¦æŸè§„åˆ™

åœ¨ `check_consistency` æ–¹æ³•ä¸­æ·»åŠ ï¼š

```python
# æ£€æŸ¥3ï¼šæ–°çš„è§„åˆ™
if condition:
    issues.append({
        'type': 'new_rule_violation',
        'severity': 'medium',
        'description': 'æè¿°é—®é¢˜',
        'suggestion': 'ä¿®æ­£å»ºè®®'
    })
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
prompt_gen_image/
â”œâ”€â”€ intelligent_generator.py          â­ æ™ºèƒ½æ¨ç†å¼•æ“
â”œâ”€â”€ .claude/skills/
â”‚   â””â”€â”€ intelligent-prompt-generator/
â”‚       â””â”€â”€ skill.md                   â­ Claude Skillå®šä¹‰
â”œâ”€â”€ generator_engine.py                (ä¿ç•™ - ç®€å•åœºæ™¯)
â”œâ”€â”€ templates.json                     (é…ç½®æ–‡ä»¶)
â””â”€â”€ elements.db                        (921å…ƒç´ æ•°æ®åº“)
```

---

## âœ… ä¸ºä»€ä¹ˆè¿™æ˜¯"æ ¹æœ¬æ€§"è§£å†³æ–¹æ¡ˆ

### âŒ ä¸´æ—¶è¡¥ä¸æ–¹æ¡ˆï¼ˆä¹‹å‰ï¼‰
```python
# è¡¥ä¸1ï¼šæ’é™¤eye_typesç±»åˆ«
if category not in excluded:
    add()

# è¡¥ä¸2ï¼šæ£€æŸ¥ç‘å…¸äºº+é»‘çš®è‚¤
if swedish and dark_skin:
    raise Error()

# è¡¥ä¸3ï¼šæ·»åŠ ä¾‹å¤–...
# è¡¥ä¸4ï¼š...
# æ°¸æ— æ­¢å¢ƒçš„if/else
```

### âœ… æ ¹æœ¬æ€§æ–¹æ¡ˆï¼ˆç°åœ¨ï¼‰
```python
# çŸ¥è¯†åº“å®šä¹‰
knowledge = load_knowledge()

# ç†è§£æ„å›¾ï¼ˆClaudeæ™ºèƒ½ï¼‰
intent = parse_intent(user_input)

# åº”ç”¨å¸¸è¯†çº¦æŸ
elements = select_by_intent(intent, knowledge)

# æ£€æŸ¥ä¸€è‡´æ€§
issues = check_consistency(elements, knowledge)

# æ™ºèƒ½ä¿®æ­£
fix(elements, issues, knowledge)
```

**å…³é”®å·®å¼‚**ï¼š
- âœ… **çŸ¥è¯†é©±åŠ¨** è€Œä¸æ˜¯è§„åˆ™å †ç Œ
- âœ… **è¯­ä¹‰ç†è§£** è€Œä¸æ˜¯å…³é”®è¯åŒ¹é…
- âœ… **å¯æ‰©å±•** - æ·»åŠ çŸ¥è¯†ï¼Œä¸æ˜¯æ·»åŠ ä»£ç 
- âœ… **æ™ºèƒ½** - Claudeç†è§£æ„å›¾ï¼Œä¸æ˜¯æœºæ¢°åŒ¹é…

---

## ğŸ“ æ€»ç»“

è¿™ä¸ªç³»ç»Ÿä¸æ˜¯"é‡åˆ°ä¸€ä¸ªbugä¿®ä¸€ä¸ª"ï¼Œè€Œæ˜¯ï¼š

1. **å»ºç«‹çŸ¥è¯†å±‚** - ethnicity â†’ typical eyes/hair
2. **è¯­ä¹‰ç†è§£å±‚** - ClaudeåŒºåˆ†å±æ€§ vs é£æ ¼
3. **æ¨ç†æ£€æŸ¥å±‚** - æ£€æµ‹é€»è¾‘å†²çª
4. **æ™ºèƒ½ä¿®æ­£å±‚** - è‡ªåŠ¨è§£å†³é—®é¢˜

**æœªæ¥é‡åˆ°æ–°é—®é¢˜**ï¼š
- âŒ ä¸éœ€è¦å†™æ–°çš„if/else
- âœ… åªéœ€è¦åœ¨knowledgeä¸­æ·»åŠ è§„åˆ™
- âœ… Claudeè‡ªåŠ¨ç†è§£å’Œåº”ç”¨

---

**è¿™æ‰æ˜¯æ ¹æœ¬æ€§çš„è§£å†³æ–¹æ¡ˆï¼** ğŸ¯

**ç‰ˆæœ¬**: 1.0
**æ—¥æœŸ**: 2026-01-02
**çŠ¶æ€**: å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡
